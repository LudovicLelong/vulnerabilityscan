---
sidebar_position: 3
title: "Utiliser spider Ajax"
---

SPider Ajax est la même solution que spider classique, mais permet de repérer plus facilement des sites dynamiques avec du javascript. Et comme tous les sites sont dynamiques et utilisent le Javascript, c'est intéressant de l'intégrer.

[Ajax classique : ](Utiliser-spider.md)

## Le code besoin dans le main pour lancer l'analyse

```
package main

import (
	"fmt"
	"vulnerabilityscan/zap-ajax-spider"
)

func main() {
	zap := ajax_spider.NewZAPv2()

	// Essayez de démarrer un nouveau scan
	scanID, err := zap.AjaxSpiderScan()
	if err != nil {
		// Vérifiez si l'erreur est due à un scan déjà en cours
		if err.Error() == "scan in progress" {
			fmt.Println("En attente de la fin du scan en cours...")

			// Attendre la fin du scan en cours
			err = zap.WaitForScanToComplete("1") // Supposons que l'ID du scan en cours est "1". Mettez l'ID correct ici si disponible.
			if err != nil {
				fmt.Printf("Erreur lors de l'attente de la fin du scan: %v\n", err)
				return
			}

			// Démarrer un nouveau scan après que l'ancien soit terminé
			fmt.Println("Démarrage d'un nouveau scan...")
			scanID, err = zap.AjaxSpiderScan()
			if err != nil {
				fmt.Printf("Erreur lors du démarrage de l'AJAX Spider: %v\n", err)
				return
			}
		} else {
			fmt.Printf("Erreur lors du démarrage de l'AJAX Spider: %v\n", err)
			return
		}
	}

	fmt.Printf("Scan démarré avec l'ID: %s\n", scanID)

	// Vérifier le statut immédiatement après le démarrage
	status, progress, err := zap.AjaxSpiderStatus(scanID)
	if err != nil {
		fmt.Printf("Erreur lors de la vérification du statut du scan: %v\n", err)
		return
	}

	fmt.Printf("Statut initial du scan: %s, progression: %s%%\n", status, progress)

	// Attendre la fin du scan
	if err := zap.WaitForScanToComplete(scanID); err != nil {
		fmt.Printf("Erreur lors de l'attente de la fin du scan: %v\n", err)
		return
	}

	fmt.Println("Scan terminé")

	// Récupérer les résultats du scan
	results, err := zap.AjaxSpiderResults(0, 100)
	if err != nil {
		fmt.Printf("Erreur lors de la récupération des résultats: %v\n", err)
		return
	}

	// Stocker les URLs dans un tableau
	var urls []string
	for _, result := range results {
		urls = append(urls, result.URL)
	}

	// Afficher les URLs trouvées
	fmt.Println("URLs trouvées par le scan AJAX:")
	for _, url := range urls {
		fmt.Println(url)
	}

	// Retourner les URLs sous forme de tableau
	fmt.Println("Tableau des URLs trouvées:")
	fmt.Println(urls)
}

```

Pour que ca marche il faut changer dans . > zap-spider-url > zap :
!["Image de code pour remplir zap api key ajax spider"](./img/zap-apikeuy-ajax-spider.png)
Remplir et mettre sa bonne clé d'API, son bon numéro de port localhost, et le site internet ("Target") dont on veut trouver tous ces liens.


Quand on lance le résultat on tombe sur un tableau avec toutes les url trouvé sur la page :
!["Résultat du scanner en utilisant l'outil Ajax spider de Zap"](../img/ajax-result.png)